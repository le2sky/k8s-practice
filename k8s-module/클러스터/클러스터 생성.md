# Minikube를 사용해서 클러스터 생성하기

## 1. 쿠버네티스 클러스터

쿠버네티스는 컴퓨터들을 연결해 단일 형상으로 동작하도록 컴퓨팅 클러스터를 구성하고 높은 가용성을 제공하도록 조율한다. 쿠버네티스는 애플리케이션 컨테이너를 클러스터에 분산시키고 스케줄링하는 일을 더욱 효울적으로 자동화한다.

**클러스터** : 여러 대의 컴퓨터들이 연결되어 하나의 시스템처럼 동작하는 컴퓨터들의 집합

**가용성** : 정보 시스템이 정상적으로 사용 가능한 정도. 다운 타임 최소화가 주요 키워드

쿠버네티스 클러스터는 두 가지 형태의 자원으로 구성된다.

    - 컨트롤 플레인
    - 노드(애플리케이션을 구동하는 워커)

## 2. 클러스터 다이어 그램

<p align="center">
<img src="../resource/module_01_cluster.svg">
</p>

**컨트롤 플레인**: 클러스터 관리를 담당한다.

    - 애플리케이션 스케줄링
    - 애플리케이션 항상성 유지
    - 새로운 변경사항을 순서대로 반영(rolling out)하는 일과 같은 클러스터 내 모든 활동을 조율

**노드**: 쿠버네티스 클러스터 내 워커 머신으로 동작하는 VM이나 물리적 컴퓨터이다.

    - 각 노드는 노드를 관리하고, 컨트롤 플레인과 통신하는 kubelet 에이전트를 가짐
    - 노드는 컨테이너 운영을 담당하는 containerd 또는 도커와 같은 툴도 갖는다.
    - 운영 트래픽을 처리하는 쿠버네티스 클러스터는 최소 세 대의 노드를 가져야 한다. 한 노드가 다운되면 etcd 멤버와 컨트롤 플레인 인스턴스가 사라져 중복성(redundancy)을 잃기 때문이다.

## 3. k8s 배포-통신 순서

1. 애플리케이션을 k8s에 배포하기 위해서는 컨트롤 플레인에 애플리케이션 컨테이너의 구동을 지시하면 된다.
2. 컨트롤 플레인은 컨테이너를 클러스터의 어느 노드에 구동시킬지 스케줄한다.
3. 노드는 컨트롤 플레인이 제공하는 k8s api를 통해서 컨트롤 플레인과 통신한다.
4. 최종사용자도 k8s api를 사용해서 클러스터와 상호작용할 수 있다.

## 4.Minikube

minikube version command

```bash
minikube version
```

running minikube

```bash
minikube start
```

## 5. Kubectl

k8s version command: server 버전과 client 버전 확인 가능

```bash
kubectl version
```

lookup cluster details: 실습환경에서는 control plane과 애드옵인 dns도 보인다.

```bash
kubectl cluster-info
```

to view the nodes in the cluster

```bash
kubectl get nodes
```
